<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Del Rio Horror Story: Vuong Manor</title>
<style>
body { margin:0; padding:0; background:#000; overflow:hidden; font-family:'Inter',sans-serif; }
canvas { display:block; margin:0 auto; background:#111; }
#hud { position:absolute; top:10px; left:50%; transform:translateX(-50%); color:#ff0000; font-size:20px; text-shadow:0 0 5px #000; z-index:10; }
#homeScreen { position:absolute; top:0; left:0; width:100%; height:100%; display:flex; flex-direction:column; justify-content:center; align-items:center; background:url('https://i.ibb.co/4Tq8R4b/haunted-mansion.jpg') no-repeat center center; background-size:cover; }
#homeScreen button { padding:15px 30px; margin:10px; font-size:22px; border:none; border-radius:10px; background:linear-gradient(90deg,#ff0000,#8b0000); color:#fff; cursor:pointer; }
</style>
</head>
<body>
<div id="homeScreen">
    <h1 style="color:#ff0000; text-shadow:0 0 10px #000;">A Del Rio Horror Story</h1>
    <button id="start2P">Start 2-Player</button>
    <button id="start1P">Start 1-Player</button>
</div>

<canvas id="gameCanvas" width="1000" height="600"></canvas>
<div id="hud">P1 Health: 100 | P2 Health: 100 | Batteries: 100%</div>

<script>
// ------------------- SETUP -------------------
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const hud = document.getElementById('hud');
const homeScreen = document.getElementById('homeScreen');
const start2P = document.getElementById('start2P');
const start1P = document.getElementById('start1P');

let keys = {};
let gameMode = '2P';
document.addEventListener('keydown', e=>keys[e.key]=true);
document.addEventListener('keyup', e=>keys[e.key]=false);

// ------------------- MAP -------------------
const map = {
    width: 2000,
    height: 1200,
    walls: [
        {x:0,y:0,w:2000,h:20}, {x:0,y:0,w:20,h:1200}, {x:0,y:1180,w:2000,h:20}, {x:1980,y:0,w:20,h:1200},
        // Living Room
        {x:100,y:100,w:400,h:300},
        // Hallway
        {x:500,y:100,w:100,h:600},
        // Buddha Room
        {x:600,y:200,w:300,h:300},
        // Clock Room
        {x:950,y:100,w:300,h:200},
        // Ballroom
        {x:600,y:600,w:500,h:400},
        // Upstairs rooms (simplified)
        {x:1000,y:50,w:400,h:200}
    ]
};

// ------------------- PLAYER CLASS -------------------
class Player{
    constructor(x,y,color,up,down,left,right){
        this.x = x;
        this.y = y;
        this.color = color;
        this.keys = {up,down,left,right};
        this.health = 100;
        this.battery = 100;
        this.radius = 15;
    }
    move(){
        let speed = 2;
        if(keys[this.keys.up]) this.y -= speed;
        if(keys[this.keys.down]) this.y += speed;
        if(keys[this.keys.left]) this.x -= speed;
        if(keys[this.keys.right]) this.x += speed;
        // Collision with walls
        for(let w of map.walls){
            if(this.x+this.radius>w.x && this.x-this.radius<w.x+w.w &&
               this.y+this.radius>w.y && this.y-this.radius<w.y+w.h){
                // Push back
                if(keys[this.keys.up]) this.y += speed;
                if(keys[this.keys.down]) this.y -= speed;
                if(keys[this.keys.left]) this.x += speed;
                if(keys[this.keys.right]) this.x -= speed;
            }
        }
    }
    draw(){
        // Player body
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);
        ctx.fillStyle = this.color;
        ctx.shadowColor=this.color;
        ctx.shadowBlur=15;
        ctx.fill();
        ctx.shadowBlur=0;
        // Flashlight cone
        let gradient = ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,150);
        gradient.addColorStop(0,'rgba(255,255,255,0.8)');
        gradient.addColorStop(1,'rgba(255,255,255,0)');
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(this.x,this.y,150,0,Math.PI*2);
        ctx.fill();
    }
}

// ------------------- INIT PLAYERS -------------------
let player1 = new Player(150,300,'#ff0000','w','s','a','d');
let player2 = new Player(850,300,'#00ff00','i','k','j','l');

// ------------------- CAMERA -------------------
let camera = {x:0,y:0,width:canvas.width,height:canvas.height};
function centerCamera(){
    let targetX = (player1.x + (gameMode==='2P'?player2.x:player1.x))/2 - canvas.width/2;
    let targetY = (player1.y + (gameMode==='2P'?player2.y:player1.y))/2 - canvas.height/2;
    camera.x = Math.max(0, Math.min(map.width-canvas.width,targetX));
    camera.y = Math.max(0, Math.min(map.height-canvas.height,targetY));
}

// ------------------- GAME LOOP -------------------
function gameLoop(){
    ctx.fillStyle='rgba(0,0,0,1)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    centerCamera();
    ctx.save();
    ctx.translate(-camera.x,-camera.y);
    // Draw walls
    ctx.fillStyle='rgba(200,200,200,0.3)';
    for(let w of map.walls){
        ctx.fillRect(w.x,w.y,w.w,w.h);
    }
    // Draw players
    player1.move(); player1.draw();
    if(gameMode==='2P'){player2.move(); player2.draw();}
    ctx.restore();
    // Update HUD
    hud.textContent = `P1 Health: ${player1.health} | P2 Health: ${player2.health} | Batteries: ${player1.battery}%`;
    requestAnimationFrame(gameLoop);
}

// ------------------- START GAME -------------------
start2P.addEventListener('click', ()=>{
    gameMode='2P';
    homeScreen.style.display='none';
    gameLoop();
});
start1P.addEventListener('click', ()=>{
    gameMode='1P';
    homeScreen.style.display='none';
    gameLoop();
});
</script>
</body>
</html>

